<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Staff Complaint Review</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f7fb; margin:0; padding:20px; }
    h1 { text-align:center; }
    .complaint { background:#fff; padding:15px; margin:10px 0; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .complaint img { max-width:150px; margin-top:8px; border-radius:6px; }
    .btn { padding:6px 12px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; }
    .btn-pass { background:#ff922b; color:#fff; float:right; }
  </style>
</head>
<body>
  <h1>Staff - Review Complaints</h1>
  <div id="staffList"></div>

  <script>
    const STUDENT_KEY = 'student_complaints_v1';
    const WARDEN_KEY = 'warden_complaints_v1';

    function loadComplaints(key) {
      const raw = localStorage.getItem(key);
      return raw ? JSON.parse(raw) : [];
    }
    function saveComplaints(key, list) {
      localStorage.setItem(key, JSON.stringify(list));
    }

    function passToWarden(id) {
      let studentList = loadComplaints(STUDENT_KEY);
      const complaint = studentList.find(c => c.id === id);
      if (!complaint) return;

      // Load warden list and push complaint
      let wardenList = loadComplaints(WARDEN_KEY);
      wardenList.push(complaint);
      saveComplaints(WARDEN_KEY, wardenList);

      // Optionally mark in student list as "forwarded"
      complaint.status = "forwarded";
      saveComplaints(STUDENT_KEY, studentList);

      alert("Complaint passed on to Warden!");
    }

    function renderStaffComplaints() {
      const list = loadComplaints(STUDENT_KEY);
      const container = document.getElementById('staffList');
      container.innerHTML = '';

      if (list.length === 0) {
        container.innerHTML = "<p>No complaints available.</p>";
        return;
      }

      list.forEach(c => {
        const div = document.createElement('div');
        div.className = 'complaint';
        div.innerHTML = `
          <strong>${c.category}</strong> - ${c.hostel}, Room ${c.room}<br>
          <small>${new Date(c.time).toLocaleString()}</small>
          <p>${c.description}</p>
          ${c.photo ? `<img src="${c.photo}" alt="photo">` : ''}
          <button class="btn btn-pass" onclick="passToWarden(${c.id})">Pass On</button>
        `;
        container.appendChild(div);
      });
    }

    renderStaffComplaints();
  </script>
</body>
</html>
